---
layout:   post
title:      近一年内评分卡工作的总结
category:  blog
description:  对近一年内评分的相关工作做一次总结
---

### 申请评分卡
##### 申请评分卡的定义：
用户授信**6个月**内在平台发生 **DPD30+** 逾期的用户，即定义为 A 卡的坏用户。没有发生逾期的用户定义为好用户；在表现期结束时，用户不满足dpd30，即逾期天数小于 30 按灰度用户处理，从数据集中删除。

需要注意的是到底定义逾期多少为坏用户，要结合催收端的策略来看。

在获取训练数据的时候，以授信时间为观察点，授信时获取的数据作为训练数据，该数据大部分为从第三方获取的数据，例如同盾，魔蝎，聚信立，百融，资金方返回的征信数据为主，同时结合少部分平台自有数据，比如：图形数据库中的关系信息，客户的自有自然属性信息等等。

##### 制定表现期：
A 卡与 B 卡的观察点的差异之处在于，**A 卡的观察点的用户的授信时点，因此每个用户的观察点会有不同，但是其表现期都是以此为起点的滞后6个月作为表现期**。而 **B 卡的观察点则是人为制定的，观察点之前的行为定义为观察期，观察点之后的时间窗口定义为表现期。每个贷中用户具有相同的观察点**。

##### 在初期探索 A 卡的踩过的坑
在最初做申请逾期模型的时候，由于缺乏经验，在提取训练数据的时候，走过很多弯路，致使模型的效果看起来很好，但完全不能在线上使用。

最初的取数逻辑为：以当前时间点往前的三个月作为表现期，所有发生过借款的用户在这段时间内出现dpd30+ ，即认为是坏用户。这种做法的问题在于：
1. 用户在出现dpd30+ 的时候，他可能已经是 dpd60+, 或者dpd180+了
2. 逾期订单可能是用户在借了很多笔之后在出现逾期的。
3. 坏用户占比不稳定，随着时间的推移，越往后坏用户越来越多

用户的表现期的时间跨度不一致，导致早期进来的用户更有可能变成A卡的坏用户；在取数的时候没有对用户的风险做区分，用户变化可能是信用风险，也有可能是行为风险，但是在初期由这两种行为导致变坏的用户统统成了A 卡的坏用户；没有充分考虑产品特性，随借随还与分期产品的坏用户定义显然应该不一样，表现期的长度也是显然不一致的。


### 行为评分卡
##### 行为评分卡的定义：
行为评分卡衡量的是贷中用户的行为风险，所以行为评分卡的用户群体在观察点时应满足授信时长超过六个月，且**借款次数超过3次**，借款次数的制定是通过分析得到，在借款3次之后，风险趋向于稳定。六个月的时长与A卡形成衔接。

##### 表现期的制定
取2017-4-15 ， 2017-7-15， 2017-10-15， 2018-01-15 为观察点，前三个月为观察期后三个月为表现期。观察点不宜距离太远，也不应距离过近。有较强外部政策影响的月份，不应纳入训练和测试数据。

B卡的一行数据为一个用户在一个观察点的行为，训练数据中可能包含一个用户的多条行为数据，数据中`customer_id` 不是唯一。

##### B卡踩过的坑
1. 数据泄漏
在初期制定用户时间窗口的时候，考虑到有一些用户在制定的时间窗口内由没有行为，所有好坏用户的时间窗口的制定逻辑是不一致的：
* 坏用户根据其最后一笔订单的逾期时间点作为其观察期的终点
* 好用户如果在制定的时间段内没有借款，则追朔到其最后一个借款时间点的后一个月为其观察期的终点。

坏用户的制定是很有问题的，因为在取观察期数据的时候已经知道了用户的是否逾期，造成了严重的数据泄漏问题，致使当初行为评分卡的KS高达0.59， AUC 达到0.89，看起来很美，但实际没有一点用户。

这样取主要是考虑到一些沉默用户和一直逾期中的用户在认为制定的时间窗口内可能没有行为，才对好坏用户的观察点做了区别对待，但实际并没有这个必要，对于沉默用户，他的行为风险本身就不大；同时也考虑到一个时间窗口可能不完全具有代表性，所以使每个用户的窗口不一样，原本是想提高泛化能力，但反而导致了过拟合。

后来采取的措施是选定多个时间窗口，任由用户在观察期内自有表现。同时在表现期观察其表现数据。多个时间窗口的观察数据合并构成训练数据， 在训练数据中，一个用户可能包含多条数据，表示这个用户在不同时间窗口内的观察行为数据和其相应的表现。即 X 与 Y.